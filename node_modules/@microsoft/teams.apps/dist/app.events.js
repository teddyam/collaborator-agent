"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.event = event;
exports.onError = onError;
exports.onActivity = onActivity;
exports.onActivitySent = onActivitySent;
exports.onActivityResponse = onActivityResponse;
/**
 * subscribe to an event
 * @param name the event to subscribe to
 * @param cb the callback to invoke
 */
function event(name, cb) {
    this.events.on(name, cb);
    return this;
}
async function onError(event) {
    for (const plugin of this.plugins) {
        if (plugin.onError) {
            await plugin.onError(event);
        }
    }
    this.events.emit('error', event);
}
async function onActivity(sender, event) {
    this.events.emit('activity', event);
    await this.process(sender, { ...event, sender });
}
async function onActivitySent(sender, event) {
    for (const plugin of this.plugins) {
        if (plugin.onActivitySent) {
            await plugin.onActivitySent({
                ...event,
                sender,
            });
        }
    }
    this.events.emit('activity.sent', { ...event, sender });
}
async function onActivityResponse(sender, event) {
    for (const plugin of this.plugins) {
        if (plugin.onActivityResponse) {
            await plugin.onActivityResponse({
                ...event,
                sender,
            });
        }
    }
    this.events.emit('activity.response', { ...event, sender });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLmV2ZW50cy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9hcHAuZXZlbnRzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBZ0JBLHNCQU1DO0FBRUQsMEJBV0M7QUFFRCxnQ0FPQztBQUVELHdDQWVDO0FBRUQsZ0RBZUM7QUFuRUQ7Ozs7R0FJRztBQUNILFNBQWdCLEtBQUssQ0FHQyxJQUFVLEVBQUUsRUFBMEM7SUFDMUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQ3pCLE9BQU8sSUFBSSxDQUFDO0FBQ2QsQ0FBQztBQUVNLEtBQUssVUFBVSxPQUFPLENBRTNCLEtBQWtCO0lBRWxCLEtBQUssTUFBTSxNQUFNLElBQUksSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQ2xDLElBQUksTUFBTSxDQUFDLE9BQU8sRUFBRSxDQUFDO1lBQ25CLE1BQU0sTUFBTSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUM5QixDQUFDO0lBQ0gsQ0FBQztJQUVELElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxLQUFLLENBQUMsQ0FBQztBQUNuQyxDQUFDO0FBRU0sS0FBSyxVQUFVLFVBQVUsQ0FFOUIsTUFBZSxFQUNmLEtBQXFCO0lBRXJCLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxLQUFLLENBQUMsQ0FBQztJQUNwQyxNQUFNLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFLEVBQUUsR0FBRyxLQUFLLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQztBQUNuRCxDQUFDO0FBRU0sS0FBSyxVQUFVLGNBQWMsQ0FFbEMsTUFBZSxFQUNmLEtBQXlCO0lBRXpCLEtBQUssTUFBTSxNQUFNLElBQUksSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQ2xDLElBQUksTUFBTSxDQUFDLGNBQWMsRUFBRSxDQUFDO1lBQzFCLE1BQU0sTUFBTSxDQUFDLGNBQWMsQ0FBQztnQkFDMUIsR0FBRyxLQUFLO2dCQUNSLE1BQU07YUFDUCxDQUFDLENBQUM7UUFDTCxDQUFDO0lBQ0gsQ0FBQztJQUVELElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLGVBQWUsRUFBRSxFQUFFLEdBQUcsS0FBSyxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUM7QUFDMUQsQ0FBQztBQUVNLEtBQUssVUFBVSxrQkFBa0IsQ0FFdEMsTUFBZSxFQUNmLEtBQTZCO0lBRTdCLEtBQUssTUFBTSxNQUFNLElBQUksSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQ2xDLElBQUksTUFBTSxDQUFDLGtCQUFrQixFQUFFLENBQUM7WUFDOUIsTUFBTSxNQUFNLENBQUMsa0JBQWtCLENBQUM7Z0JBQzlCLEdBQUcsS0FBSztnQkFDUixNQUFNO2FBQ1AsQ0FBQyxDQUFDO1FBQ0wsQ0FBQztJQUNILENBQUM7SUFFRCxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxFQUFFLEdBQUcsS0FBSyxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUM7QUFDOUQsQ0FBQyJ9