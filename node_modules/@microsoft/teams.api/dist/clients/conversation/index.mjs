import qs from 'qs';
import { Client } from '@microsoft/teams.common/http';
import { ConversationActivityClient } from './activity';
export * from './activity';
import { ConversationMemberClient } from './member';
export * from './member';

class ConversationClient {
  serviceUrl;
  get http() {
    return this._http;
  }
  set http(v) {
    this._http = v;
  }
  _http;
  _activities;
  _members;
  constructor(serviceUrl, options) {
    this.serviceUrl = serviceUrl;
    if (!options) {
      this._http = new Client();
    } else if ("request" in options) {
      this._http = options;
    } else {
      this._http = new Client(options);
    }
    this._activities = new ConversationActivityClient(serviceUrl, this.http);
    this._members = new ConversationMemberClient(serviceUrl, this.http);
  }
  activities(conversationId) {
    return {
      create: (params) => this._activities.create(conversationId, params),
      update: (id, params) => this._activities.update(conversationId, id, params),
      reply: (id, params) => this._activities.reply(conversationId, id, params),
      delete: (id) => this._activities.delete(conversationId, id),
      members: (activityId) => this._activities.getMembers(conversationId, activityId)
    };
  }
  members(conversationId) {
    return {
      get: () => this._members.get(conversationId),
      getById: (id) => this._members.getById(conversationId, id),
      delete: (id) => this._members.delete(conversationId, id)
    };
  }
  async get(params) {
    const q = qs.stringify(params, { addQueryPrefix: true });
    const res = await this.http.get(
      `${this.serviceUrl}/v3/conversations${q}`
    );
    return res.data;
  }
  async create(params) {
    const res = await this.http.post(
      `${this.serviceUrl}/v3/conversations`,
      params
    );
    return res.data;
  }
}

export { ConversationClient };
//# sourceMappingURL=index.mjs.map
//# sourceMappingURL=index.mjs.map